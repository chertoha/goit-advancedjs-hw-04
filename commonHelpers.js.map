{"version":3,"file":"commonHelpers.js","sources":["../src/js/config.js","../src/js/pixabayAPI.js","../src/js/toast.js","../src/js/gallery/createGallery.js","../src/js/gallery/gallery-markup.js","../src/js/gallery/gallery.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '40477492-fb7a942987769cd06fc4fed72';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const PER_PAGE = 40;\n\nexport const api = axios.create({\n  baseURL: BASE_URL,\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  },\n});\n","import { api } from './config';\n\nexport const fetchImages = async (query, page = 1, limit = 20) => {\n  const response = await api.get('', {\n    params: {\n      q: query,\n      page,\n      per_page: limit,\n    },\n  });\n\n  const { hits, totalHits } = response.data;\n  return { list: hits, total: totalHits };\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  timeout: 4000,\n  position: 'topRight',\n  maxWidth: '400px',\n});\n\nconst warning = message => {\n  iziToast.warning({\n    title: 'Attention!',\n    message,\n  });\n};\n\nconst error = message => {\n  iziToast.error({\n    title: 'Error!',\n    message,\n  });\n};\n\nconst success = message => {\n  iziToast.success({\n    title: 'Success!',\n    message,\n  });\n};\n\nexport const toast = {\n  emptyList: message => {\n    warning(\n      message ||\n        'Sorry, there are no images matching your search query. Please try again.'\n    );\n  },\n\n  endCollection: message => {\n    warning(\n      message || \"We're sorry, but you've reached the end of search results.\"\n    );\n  },\n\n  fetchError: message => {\n    error(message || 'Sorry. Something went wrong while fetching!');\n  },\n\n  foundTotal: total => {\n    success(`Hooray! We found ${total} images.`);\n  },\n};\n","import { fetchImages } from '../pixabayAPI';\nimport { toast } from '../toast';\n\nexport function createGallery(\n  procedure,\n  {\n    initialPage,\n    limit,\n    initialQuery,\n    initialList,\n    loader,\n    smoothScroll,\n    loadMore,\n  }\n) {\n  let page = initialPage || 1;\n  let query = initialQuery || '';\n  let list = initialList || [];\n  let total = null;\n\n  async function fetchData() {\n    if (!query) return;\n    try {\n      loader && loader.start();\n      loadMore.hide();\n\n      const data = await fetchImages(query, page, limit);\n\n      console.log('data', data);\n\n      list.push(...data.list);\n      total = data.total;\n\n      const isEndCollection = limit * page >= total;\n\n      if (data.list.length === 0) {\n        toast.emptyList();\n      } else if (isEndCollection) {\n        toast.endCollection();\n      } else if (page === 1) {\n        toast.foundTotal(total);\n      }\n\n      procedure(list);\n\n      if (!isEndCollection) loadMore.show();\n\n      smoothScroll && smoothScroll();\n    } catch (error) {\n      toast.fetchError();\n    } finally {\n      loader && loader.stop();\n    }\n  }\n\n  return {\n    getPage() {\n      return page;\n    },\n\n    increasePage() {\n      page += 1;\n      fetchData();\n    },\n\n    resetPage() {\n      page = initialPage || 1;\n    },\n\n    setQuery(newQuery) {\n      this.resetPage();\n      this.clearList();\n      query = newQuery;\n      fetchData();\n    },\n\n    clearList() {\n      list = [];\n    },\n  };\n}\n","export function createGAlleryMarkup(list) {\n  return list.map(createGalleryMarkup).join('');\n}\n\nfunction createGalleryMarkup({\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n  webformatURL,\n}) {\n  return `\n  <div class=\"photo-card\">\n    <a class=\"photo-card__link\" href=\"${largeImageURL}\">\n        <img class=\"photo-card__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    </a>    \n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b><span>${likes}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Views</b><span>${views}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b><span>${comments}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b><span>${downloads}</span>\n        </p>\n    </div>\n</div>`;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { PER_PAGE } from '../config';\nimport { createGallery } from './createGallery';\nimport { createGAlleryMarkup } from './gallery-markup';\n\nconst form = document.querySelector('.search');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  showCounter: false,\n});\n\nconst galleryIstance = createGallery(render, {\n  limit: PER_PAGE,\n  loader: createloader(),\n  smoothScroll,\n  loadMore: createLoadMore(),\n});\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  const query = e.target.elements.searchQuery.value.trim();\n\n  galleryIstance.setQuery(query);\n});\n\nloadMoreBtn.addEventListener('click', () => {\n  galleryIstance.increasePage();\n});\n\n//----------------------------Helpers\nfunction render(data) {\n  const markup = createGAlleryMarkup(data);\n  gallery.innerHTML = '';\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction createloader() {\n  const loaderRef = document.querySelector('.loader');\n  loaderRef.style.display = 'none';\n\n  return {\n    start() {\n      loaderRef.style.display = 'block';\n    },\n\n    stop() {\n      loaderRef.style.display = 'none';\n    },\n  };\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction createLoadMore() {\n  loadMoreBtn.style.display = 'none';\n\n  return {\n    show() {\n      loadMoreBtn.style.display = 'block';\n    },\n    hide() {\n      loadMoreBtn.style.display = 'none';\n    },\n  };\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","api","axios","fetchImages","query","page","limit","response","hits","totalHits","iziToast","warning","message","error","success","toast","total","createGallery","procedure","initialPage","initialQuery","initialList","loader","smoothScroll","loadMore","list","fetchData","data","isEndCollection","newQuery","createGAlleryMarkup","createGalleryMarkup","largeImageURL","tags","likes","views","comments","downloads","webformatURL","form","gallery","loadMoreBtn","lightbox","SimpleLightbox","galleryIstance","render","createloader","createLoadMore","markup","loaderRef","cardHeight"],"mappings":"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"}